import pygame
from os import path
import os
import sys

x = os.sep.join(['..','..','scripts','Lib','site-packages'])
print(x)
sys.path.append(x)

from gamecrm.model.GlobOwnershipLands import GlobOwnershipLands
from gamecrm.shared.WorldMap import WorldMap

stored_map = """[
   [
      30,
      27
   ],
   [
      60,
      70
   ],
   {
      "151":[
         [
            1,
            23
         ],
         [
            2,
            22
         ],
         [
            2,
            21
         ],
         [
            1,
            21
         ],
         [
            2,
            20
         ],
         [
            3,
            20
         ],
         [
            1,
            22
         ],
         [
            2,
            23
         ],
         [
            3,
            24
         ],
         [
            2,
            24
         ],
         [
            4,
            24
         ],
         [
            1,
            24
         ],
         [
            1,
            25
         ],
         [
            2,
            25
         ],
         [
            1,
            26
         ],
         [
            2,
            26
         ],
         [
            3,
            26
         ]
      ],
      "152":[
         [
            6,
            12
         ],
         [
            6,
            13
         ],
         [
            7,
            12
         ],
         [
            7,
            13
         ],
         [
            7,
            11
         ],
         [
            8,
            13
         ],
         [
            9,
            12
         ],
         [
            8,
            14
         ],
         [
            7,
            15
         ],
         [
            8,
            15
         ],
         [
            8,
            16
         ],
         [
            6,
            14
         ],
         [
            5,
            13
         ],
         [
            9,
            15
         ],
         [
            9,
            16
         ],
         [
            7,
            14
         ],
         [
            10,
            16
         ],
         [
            8,
            10
         ],
         [
            8,
            11
         ],
         [
            9,
            17
         ],
         [
            8,
            12
         ]
      ],
      "153":[
         [
            4,
            15
         ],
         [
            5,
            14
         ],
         [
            4,
            16
         ],
         [
            5,
            15
         ],
         [
            4,
            14
         ],
         [
            6,
            16
         ],
         [
            6,
            17
         ],
         [
            5,
            16
         ],
         [
            3,
            13
         ],
         [
            7,
            16
         ],
         [
            6,
            18
         ],
         [
            3,
            16
         ],
         [
            3,
            15
         ],
         [
            7,
            17
         ],
         [
            8,
            17
         ],
         [
            3,
            14
         ],
         [
            6,
            15
         ],
         [
            2,
            15
         ],
         [
            2,
            14
         ]
      ],
      "154":[
         [
            15,
            24
         ],
         [
            15,
            23
         ],
         [
            16,
            22
         ],
         [
            14,
            23
         ],
         [
            16,
            24
         ],
         [
            17,
            22
         ],
         [
            15,
            21
         ],
         [
            15,
            22
         ],
         [
            17,
            21
         ],
         [
            16,
            25
         ],
         [
            16,
            26
         ],
         [
            18,
            21
         ],
         [
            17,
            25
         ],
         [
            18,
            20
         ],
         [
            17,
            24
         ],
         [
            16,
            23
         ],
         [
            17,
            23
         ],
         [
            18,
            25
         ],
         [
            18,
            24
         ],
         [
            17,
            26
         ],
         [
            19,
            26
         ]
      ],
      "155":[
         [
            19,
            20
         ],
         [
            19,
            21
         ],
         [
            18,
            19
         ],
         [
            20,
            22
         ],
         [
            19,
            22
         ],
         [
            19,
            18
         ],
         [
            18,
            23
         ],
         [
            19,
            19
         ],
         [
            20,
            18
         ],
         [
            18,
            22
         ],
         [
            18,
            18
         ],
         [
            19,
            17
         ],
         [
            20,
            23
         ],
         [
            21,
            22
         ],
         [
            20,
            24
         ],
         [
            19,
            23
         ],
         [
            21,
            23
         ],
         [
            19,
            24
         ],
         [
            19,
            25
         ],
         [
            22,
            22
         ],
         [
            20,
            21
         ]
      ],
      "156":[
         [
            4,
            10
         ],
         [
            3,
            10
         ],
         [
            4,
            9
         ],
         [
            5,
            8
         ],
         [
            4,
            7
         ],
         [
            3,
            9
         ],
         [
            2,
            11
         ],
         [
            2,
            10
         ],
         [
            4,
            8
         ],
         [
            4,
            6
         ],
         [
            2,
            9
         ],
         [
            5,
            7
         ],
         [
            1,
            11
         ],
         [
            3,
            7
         ],
         [
            3,
            8
         ],
         [
            4,
            5
         ],
         [
            5,
            6
         ],
         [
            2,
            7
         ],
         [
            3,
            6
         ],
         [
            6,
            6
         ],
         [
            6,
            5
         ]
      ],
      "157":[
         [
            16,
            6
         ],
         [
            15,
            6
         ],
         [
            16,
            5
         ],
         [
            17,
            4
         ],
         [
            14,
            7
         ],
         [
            17,
            3
         ],
         [
            15,
            7
         ],
         [
            17,
            6
         ],
         [
            16,
            7
         ],
         [
            15,
            8
         ],
         [
            18,
            6
         ],
         [
            17,
            7
         ],
         [
            19,
            6
         ],
         [
            15,
            9
         ],
         [
            15,
            10
         ],
         [
            18,
            7
         ],
         [
            14,
            10
         ],
         [
            14,
            9
         ],
         [
            16,
            8
         ],
         [
            13,
            11
         ],
         [
            16,
            10
         ]
      ],
      "158":[
         [
            27,
            18
         ],
         [
            26,
            19
         ],
         [
            26,
            17
         ],
         [
            26,
            18
         ],
         [
            27,
            17
         ],
         [
            25,
            18
         ],
         [
            27,
            16
         ],
         [
            28,
            16
         ],
         [
            24,
            19
         ],
         [
            24,
            18
         ],
         [
            29,
            16
         ],
         [
            25,
            20
         ],
         [
            23,
            19
         ],
         [
            24,
            20
         ],
         [
            28,
            15
         ],
         [
            23,
            20
         ],
         [
            24,
            21
         ],
         [
            25,
            21
         ],
         [
            23,
            21
         ],
         [
            22,
            21
         ],
         [
            24,
            17
         ]
      ],
      "159":[
         [
            0,
            19
         ],
         [
            1,
            19
         ],
         [
            1,
            20
         ],
         [
            1,
            18
         ],
         [
            2,
            19
         ],
         [
            3,
            18
         ],
         [
            3,
            19
         ],
         [
            2,
            18
         ],
         [
            4,
            18
         ],
         [
            5,
            18
         ],
         [
            3,
            17
         ],
         [
            2,
            17
         ],
         [
            4,
            17
         ],
         [
            1,
            17
         ],
         [
            1,
            16
         ],
         [
            5,
            17
         ],
         [
            2,
            16
         ],
         [
            1,
            15
         ],
         [
            1,
            14
         ]
      ],
      "160":[
         [
            19,
            13
         ],
         [
            19,
            14
         ],
         [
            20,
            14
         ],
         [
            19,
            12
         ],
         [
            19,
            15
         ],
         [
            19,
            11
         ],
         [
            18,
            13
         ],
         [
            20,
            12
         ],
         [
            21,
            14
         ],
         [
            18,
            14
         ],
         [
            20,
            13
         ],
         [
            18,
            15
         ],
         [
            17,
            15
         ],
         [
            19,
            16
         ],
         [
            16,
            15
         ],
         [
            18,
            12
         ],
         [
            21,
            12
         ],
         [
            22,
            14
         ],
         [
            17,
            13
         ],
         [
            21,
            13
         ],
         [
            16,
            13
         ]
      ],
      "161":[
         [
            20,
            4
         ],
         [
            19,
            5
         ],
         [
            19,
            4
         ],
         [
            19,
            3
         ],
         [
            20,
            3
         ],
         [
            18,
            5
         ],
         [
            18,
            4
         ],
         [
            18,
            3
         ],
         [
            17,
            5
         ],
         [
            20,
            2
         ],
         [
            19,
            2
         ],
         [
            20,
            5
         ],
         [
            19,
            1
         ],
         [
            20,
            6
         ],
         [
            21,
            6
         ],
         [
            21,
            5
         ],
         [
            22,
            6
         ],
         [
            19,
            7
         ],
         [
            20,
            8
         ],
         [
            22,
            4
         ],
         [
            19,
            8
         ]
      ],
      "162":[
         [
            26,
            26
         ],
         [
            26,
            25
         ],
         [
            26,
            24
         ],
         [
            27,
            26
         ],
         [
            28,
            26
         ],
         [
            27,
            24
         ],
         [
            27,
            25
         ],
         [
            25,
            25
         ],
         [
            28,
            24
         ],
         [
            26,
            23
         ],
         [
            28,
            25
         ],
         [
            24,
            25
         ],
         [
            24,
            26
         ],
         [
            29,
            24
         ],
         [
            29,
            25
         ],
         [
            29,
            23
         ],
         [
            28,
            23
         ],
         [
            25,
            23
         ],
         [
            23,
            25
         ],
         [
            29,
            26
         ],
         [
            27,
            23
         ]
      ],
      "163":[
         [
            28,
            11
         ],
         [
            29,
            11
         ],
         [
            28,
            12
         ],
         [
            29,
            10
         ],
         [
            27,
            11
         ],
         [
            27,
            13
         ],
         [
            27,
            12
         ],
         [
            26,
            13
         ],
         [
            28,
            14
         ],
         [
            29,
            9
         ],
         [
            26,
            11
         ],
         [
            27,
            15
         ],
         [
            28,
            13
         ],
         [
            26,
            10
         ],
         [
            29,
            14
         ],
         [
            29,
            12
         ],
         [
            29,
            15
         ],
         [
            28,
            10
         ],
         [
            27,
            10
         ],
         [
            28,
            9
         ],
         [
            29,
            13
         ]
      ],
      "164":[
         [
            21,
            9
         ],
         [
            20,
            9
         ],
         [
            21,
            10
         ],
         [
            21,
            8
         ],
         [
            21,
            7
         ],
         [
            22,
            9
         ],
         [
            20,
            7
         ],
         [
            20,
            11
         ],
         [
            22,
            8
         ],
         [
            22,
            7
         ],
         [
            23,
            6
         ],
         [
            23,
            10
         ],
         [
            20,
            10
         ],
         [
            22,
            10
         ],
         [
            23,
            8
         ],
         [
            19,
            9
         ],
         [
            24,
            6
         ],
         [
            25,
            6
         ],
         [
            24,
            5
         ],
         [
            25,
            5
         ],
         [
            19,
            10
         ]
      ],
      "165":[
         [
            12,
            26
         ],
         [
            12,
            25
         ],
         [
            13,
            26
         ],
         [
            14,
            26
         ],
         [
            11,
            25
         ],
         [
            11,
            26
         ],
         [
            10,
            25
         ],
         [
            15,
            26
         ],
         [
            11,
            24
         ],
         [
            15,
            25
         ],
         [
            10,
            24
         ],
         [
            10,
            26
         ],
         [
            9,
            24
         ],
         [
            9,
            25
         ],
         [
            9,
            26
         ],
         [
            8,
            24
         ],
         [
            8,
            25
         ]
      ],
      "166":[
         [
            23,
            0
         ],
         [
            23,
            1
         ],
         [
            22,
            1
         ],
         [
            21,
            1
         ],
         [
            22,
            2
         ],
         [
            23,
            2
         ],
         [
            22,
            3
         ],
         [
            20,
            1
         ],
         [
            24,
            2
         ],
         [
            21,
            3
         ],
         [
            23,
            4
         ],
         [
            22,
            5
         ],
         [
            21,
            4
         ],
         [
            21,
            2
         ],
         [
            23,
            5
         ],
         [
            24,
            1
         ],
         [
            24,
            3
         ],
         [
            25,
            2
         ],
         [
            25,
            3
         ],
         [
            24,
            4
         ],
         [
            23,
            3
         ]
      ],
      "167":[
         [
            5,
            11
         ],
         [
            5,
            10
         ],
         [
            4,
            11
         ],
         [
            5,
            12
         ],
         [
            6,
            10
         ],
         [
            4,
            13
         ],
         [
            6,
            9
         ],
         [
            4,
            12
         ],
         [
            7,
            10
         ],
         [
            6,
            11
         ],
         [
            5,
            9
         ],
         [
            6,
            8
         ],
         [
            3,
            12
         ],
         [
            7,
            8
         ],
         [
            7,
            9
         ],
         [
            2,
            12
         ],
         [
            2,
            13
         ],
         [
            1,
            13
         ],
         [
            3,
            11
         ],
         [
            8,
            8
         ],
         [
            1,
            12
         ]
      ],
      "168":[
         [
            2,
            0
         ],
         [
            2,
            1
         ],
         [
            1,
            1
         ],
         [
            3,
            2
         ],
         [
            2,
            2
         ],
         [
            2,
            3
         ],
         [
            1,
            3
         ],
         [
            1,
            2
         ],
         [
            3,
            3
         ],
         [
            2,
            4
         ],
         [
            4,
            4
         ],
         [
            3,
            4
         ],
         [
            5,
            4
         ],
         [
            4,
            2
         ],
         [
            5,
            3
         ],
         [
            1,
            4
         ],
         [
            1,
            5
         ],
         [
            4,
            3
         ],
         [
            1,
            6
         ],
         [
            3,
            5
         ],
         [
            2,
            5
         ]
      ],
      "169":[
         [
            14,
            5
         ],
         [
            14,
            6
         ],
         [
            15,
            5
         ],
         [
            13,
            5
         ],
         [
            13,
            6
         ],
         [
            12,
            7
         ],
         [
            13,
            4
         ],
         [
            13,
            7
         ],
         [
            15,
            4
         ],
         [
            16,
            4
         ],
         [
            12,
            5
         ],
         [
            12,
            6
         ],
         [
            12,
            8
         ],
         [
            12,
            3
         ],
         [
            14,
            4
         ],
         [
            13,
            8
         ],
         [
            11,
            9
         ],
         [
            11,
            7
         ],
         [
            12,
            9
         ],
         [
            11,
            10
         ],
         [
            12,
            4
         ]
      ],
      "170":[
         [
            24,
            10
         ],
         [
            24,
            9
         ],
         [
            25,
            9
         ],
         [
            25,
            8
         ],
         [
            23,
            9
         ],
         [
            24,
            8
         ],
         [
            24,
            7
         ],
         [
            25,
            10
         ],
         [
            24,
            11
         ],
         [
            23,
            7
         ],
         [
            26,
            8
         ],
         [
            25,
            7
         ],
         [
            26,
            7
         ],
         [
            26,
            6
         ],
         [
            23,
            11
         ],
         [
            26,
            5
         ],
         [
            27,
            4
         ],
         [
            28,
            4
         ],
         [
            27,
            5
         ],
         [
            27,
            6
         ],
         [
            28,
            5
         ]
      ],
      "171":[
         [
            26,
            16
         ],
         [
            25,
            15
         ],
         [
            26,
            14
         ],
         [
            26,
            15
         ],
         [
            25,
            13
         ],
         [
            26,
            12
         ],
         [
            25,
            12
         ],
         [
            24,
            15
         ],
         [
            25,
            11
         ],
         [
            24,
            12
         ],
         [
            25,
            14
         ],
         [
            24,
            13
         ],
         [
            24,
            14
         ],
         [
            23,
            13
         ],
         [
            25,
            17
         ],
         [
            25,
            16
         ],
         [
            23,
            14
         ],
         [
            27,
            14
         ],
         [
            23,
            15
         ],
         [
            23,
            12
         ],
         [
            22,
            13
         ]
      ],
      "172":[
         [
            7,
            23
         ],
         [
            8,
            23
         ],
         [
            9,
            22
         ],
         [
            7,
            24
         ],
         [
            6,
            25
         ],
         [
            9,
            23
         ],
         [
            8,
            22
         ],
         [
            7,
            25
         ],
         [
            8,
            21
         ],
         [
            8,
            26
         ],
         [
            10,
            22
         ],
         [
            10,
            23
         ],
         [
            7,
            26
         ],
         [
            9,
            21
         ],
         [
            11,
            22
         ],
         [
            6,
            26
         ],
         [
            10,
            21
         ],
         [
            10,
            20
         ],
         [
            11,
            20
         ],
         [
            10,
            19
         ],
         [
            11,
            19
         ]
      ],
      "173":[
         [
            5,
            22
         ],
         [
            4,
            22
         ],
         [
            4,
            21
         ],
         [
            4,
            20
         ],
         [
            3,
            21
         ],
         [
            5,
            21
         ],
         [
            5,
            20
         ],
         [
            5,
            19
         ],
         [
            6,
            21
         ],
         [
            3,
            22
         ],
         [
            6,
            20
         ],
         [
            6,
            19
         ],
         [
            4,
            19
         ],
         [
            7,
            18
         ],
         [
            8,
            18
         ],
         [
            8,
            19
         ],
         [
            9,
            18
         ],
         [
            9,
            19
         ],
         [
            10,
            18
         ],
         [
            10,
            17
         ],
         [
            11,
            18
         ]
      ],
      "174":[
         [
            16,
            20
         ],
         [
            15,
            19
         ],
         [
            16,
            21
         ],
         [
            17,
            20
         ],
         [
            16,
            19
         ],
         [
            16,
            18
         ],
         [
            16,
            17
         ],
         [
            15,
            17
         ],
         [
            14,
            19
         ],
         [
            17,
            16
         ],
         [
            17,
            17
         ],
         [
            18,
            16
         ],
         [
            16,
            16
         ],
         [
            17,
            19
         ],
         [
            13,
            19
         ],
         [
            17,
            18
         ],
         [
            15,
            16
         ],
         [
            13,
            18
         ],
         [
            15,
            18
         ],
         [
            18,
            17
         ],
         [
            14,
            18
         ]
      ],
      "175":[
         [
            27,
            19
         ],
         [
            28,
            18
         ],
         [
            28,
            19
         ],
         [
            29,
            19
         ],
         [
            27,
            20
         ],
         [
            26,
            20
         ],
         [
            25,
            19
         ],
         [
            28,
            20
         ],
         [
            28,
            17
         ],
         [
            27,
            21
         ],
         [
            29,
            18
         ],
         [
            29,
            17
         ],
         [
            26,
            21
         ],
         [
            27,
            22
         ],
         [
            29,
            20
         ],
         [
            28,
            22
         ],
         [
            28,
            21
         ],
         [
            29,
            21
         ],
         [
            26,
            22
         ],
         [
            29,
            22
         ],
         [
            25,
            22
         ]
      ],
      "176":[
         [
            8,
            5
         ],
         [
            9,
            6
         ],
         [
            9,
            4
         ],
         [
            9,
            5
         ],
         [
            8,
            6
         ],
         [
            9,
            3
         ],
         [
            10,
            6
         ],
         [
            10,
            3
         ],
         [
            11,
            4
         ],
         [
            10,
            5
         ],
         [
            8,
            7
         ],
         [
            10,
            4
         ],
         [
            7,
            7
         ],
         [
            11,
            6
         ],
         [
            9,
            7
         ],
         [
            8,
            3
         ],
         [
            6,
            7
         ],
         [
            9,
            2
         ],
         [
            10,
            2
         ],
         [
            10,
            8
         ],
         [
            9,
            8
         ]
      ],
      "177":[
         [
            13,
            25
         ],
         [
            14,
            24
         ],
         [
            13,
            24
         ],
         [
            14,
            25
         ],
         [
            13,
            23
         ],
         [
            12,
            23
         ],
         [
            14,
            22
         ],
         [
            12,
            24
         ],
         [
            13,
            22
         ],
         [
            14,
            21
         ],
         [
            13,
            21
         ],
         [
            12,
            21
         ],
         [
            15,
            20
         ],
         [
            12,
            22
         ],
         [
            11,
            23
         ],
         [
            13,
            20
         ],
         [
            12,
            19
         ],
         [
            12,
            20
         ],
         [
            14,
            20
         ],
         [
            11,
            21
         ],
         [
            12,
            18
         ]
      ],
      "178":[
         [
            22,
            17
         ],
         [
            22,
            16
         ],
         [
            22,
            18
         ],
         [
            21,
            17
         ],
         [
            21,
            15
         ],
         [
            22,
            15
         ],
         [
            20,
            15
         ],
         [
            21,
            16
         ],
         [
            20,
            16
         ],
         [
            23,
            17
         ],
         [
            23,
            18
         ],
         [
            24,
            16
         ],
         [
            22,
            19
         ],
         [
            23,
            16
         ],
         [
            22,
            20
         ],
         [
            21,
            19
         ],
         [
            20,
            17
         ],
         [
            21,
            18
         ],
         [
            21,
            21
         ],
         [
            21,
            20
         ],
         [
            20,
            19
         ]
      ],
      "179":[
         [
            16,
            2
         ],
         [
            16,
            1
         ],
         [
            15,
            1
         ],
         [
            16,
            3
         ],
         [
            15,
            2
         ],
         [
            17,
            1
         ],
         [
            18,
            1
         ],
         [
            14,
            3
         ],
         [
            14,
            1
         ],
         [
            15,
            3
         ],
         [
            17,
            2
         ],
         [
            18,
            2
         ],
         [
            14,
            2
         ],
         [
            13,
            1
         ],
         [
            13,
            3
         ],
         [
            13,
            2
         ],
         [
            12,
            1
         ],
         [
            12,
            2
         ],
         [
            11,
            2
         ],
         [
            11,
            3
         ],
         [
            10,
            1
         ]
      ],
      "180":[
         [
            5,
            23
         ],
         [
            4,
            23
         ],
         [
            6,
            23
         ],
         [
            6,
            22
         ],
         [
            6,
            24
         ],
         [
            3,
            23
         ],
         [
            5,
            24
         ],
         [
            7,
            22
         ],
         [
            7,
            21
         ],
         [
            8,
            20
         ],
         [
            7,
            19
         ],
         [
            4,
            25
         ],
         [
            7,
            20
         ],
         [
            3,
            25
         ],
         [
            9,
            20
         ],
         [
            5,
            25
         ],
         [
            4,
            26
         ],
         [
            5,
            26
         ]
      ]
   },
   {
      "174":0,
      "153":0,
      "155":0,
      "176":0,
      "168":0,
      "156":0,
      "169":0,
      "171":1,
      "172":1,
      "159":1,
      "154":1,
      "170":1,
      "167":1,
      "166":1,
      "152":2,
      "178":2,
      "163":2,
      "179":2,
      "158":2,
      "177":2,
      "180":2,
      "160":3,
      "165":3,
      "161":3,
      "175":3,
      "164":3,
      "173":3,
      "157":3,
      "162":1,
      "151":2
   }
]
"""


def test_worldmap():
    global stored_map
    """
    test code to show that it is working
    dirty hacks in here, so dont look at the code!
    """

    pygame.init()
    screen = pygame.display.set_mode((800, 600))

    numgrid_x, numgrid_y = 30, 27
    # numgrid_x, numgrid_y = 31, 27
    # grid_offset = (100, 0)
    grid_offset = (50, 10)
    world = WorldMap.gen_random((numgrid_x, numgrid_y), grid_offset, cells_in_land=20, percent_grid_fill=0.3)
    print("grid has", numgrid_x * numgrid_y, "cells")

    num = 0
    for cell, land in world.cells.items():
        if land:
            num += 1
    print("occupied cells: ",
          num,
          float(num) / (numgrid_x * numgrid_y),
          world._num_filled_cells,
          float(world._num_filled_cells) / (numgrid_x * numgrid_y))

    tile = pygame.image.load(
        path.join('data', 'images', 'hextile.PNG')).convert()
    tile.set_colorkey((0x80, 0x00, 0x80))
    curtile = pygame.image.load(
        path.join('data', 'images', 'cursorhextile.PNG')).convert()
    curtile.set_colorkey((0x80, 0x00, 0x80))
    adjtile = pygame.image.load(
        path.join('data', 'images', 'adjhextile.PNG')).convert()
    adjtile.set_colorkey((0x80, 0x00, 0x80))
    pos = pygame.mouse.get_pos()

    running = True

    while running:
        # event handling
        event = pygame.event.wait()
        if event.type == pygame.QUIT or \
                (event.type == pygame.KEYDOWN and event.key == pygame.K_ESCAPE):
            running = False

        elif event.type == pygame.KEYUP:
            if event.key == pygame.K_SPACE:
                world = WorldMap.gen_random((numgrid_x, numgrid_y), grid_offset, cells_in_land=20, percent_grid_fill=0.3)
                # world.randomize()

        elif event.type == pygame.KEYDOWN:
            if event.unicode == 's':
                stored_map = world.serialize()
                print(">>>>>>>>>>>>>>>>>>>>map saved!!")
                print(stored_map)
            elif event.unicode == 'r':
                if stored_map:
                    world = WorldMap.deserialize(stored_map)
                    print(">>>>>>>>>>>>>map restored!!")

        # draw tile ons screen
        for land in world.get_lands():
            ##            color = world.testcolors[land._id]
            ##            i.fill(color)
            for cell in land.cells:
                ##                screen.blit(i, world.grid.gridToAbs(c))
                screen.blit(tile, world.grid.grid_to_abs(cell))

        # draw highlighted land
        if event.type == pygame.MOUSEMOTION:
            pos = event.pos
        ##            print "cell:", world.grid.abs_to_grid(pos)
        land = world.get_land_from_abs(pos)
        if land:
            ##            i.fill((255, 0, 0))
            for cell in land.cells:
                ##                screen.blit(i, world.grid.gridToAbs(c))
                screen.blit(curtile, world.grid.grid_to_abs(cell))

        # draw adjectand lands if mouse button is pressed
        if pygame.mouse.get_pressed(num_buttons=3) != (0, 0, 0):
            land = world.get_land_from_abs(pygame.mouse.get_pos())
            if land:
                i.fill((255, 0, 255))
                for adjland in land._links:
                    for cell in adjland.cells:
                        ##                        screen.blit(i, world.grid.gridToAbs(c))
                        screen.blit(adjtile, world.grid.grid_to_abs(cell))

        # draw origin cell
        img = pygame.Surface((15, 15))
        img.fill((255, 0, 255))  # pink color
        for land in world.get_lands():
            origin_cell = land._cells[0]
            screen.blit(img, world.grid.grid_to_abs(origin_cell))
        # -----testing ----#FF0000#FFFF00----

        # draw center cell
        i = pygame.Surface((10, 10))
        i.fill((0, 255, 0))
        for land in world.get_lands():
            screen.blit(i, world.grid.grid_to_abs(land.get_center_cell()))

        pygame.display.flip()
        screen.fill((0,) * 3)

    pygame.quit()
    print('bye!')


if __name__ == '__main__':
    test_worldmap()
